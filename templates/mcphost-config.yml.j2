# Autogenerated by ansible-ollama_mcphost on {{ ansible_date_time.iso8601 }}

model: "ollama:{{ ollama_model }}"
provider-url: "http://{{ ollama_host }}:{{ ollama_service_port }}"
max-tokens: {{ mcphost_max_tokens }}
temperature: {{ mcphost_temperature }}
max-steps: {{ mcphost_max_steps }}
stream: {{ mcphost_stream | lower }}
debug: {{ mcphost_debug | lower }}

{% if mcphost_system_prompt %}
system-prompt: |
{{ mcphost_system_prompt | indent(2) }}
{% endif %}

mcpServers:
{% if mcphost_local_servers | length > 0 %}
{% for server in mcphost_local_servers %}
  {{ server.name }}:
    type: "{{ server.type | default('local') }}"
    command: {{ server.command | default(['python3', server.path]) | to_json }}
{% if server.cwd is defined %}
    cwd: "{{ server.cwd }}"
{% endif %}
{% if server.env is defined %}
    environment:
{% for key, value in server.env.items() %}
      {{ key }}: "{{ value }}"
{% endfor %}
{% endif %}
{% if server.description is defined %}
    description: "{{ server.description }}"
{% endif %}
{% endfor %}
{% else %}
  {}
{% endif %}

servers:
{% set endpoints = mcphost_endpoints_effective | default([]) %}
{% if endpoints | length > 0 %}
{% for endpoint in endpoints %}
  - name: "{{ endpoint.name }}"
    endpoint: "{{ endpoint.endpoint }}"
{% if endpoint.description is defined %}
    description: "{{ endpoint.description }}"
{% endif %}
{% endfor %}
{% else %}
  []
{% endif %}
