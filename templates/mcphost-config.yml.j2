# Autogenerated by ansible-ollama_mcphost on {{ ansible_date_time.iso8601 }}

# Model configuration
model: "{{ mcphost_model_provider }}:{{ mcphost_model_name }}"
{% if mcphost_provider_url %}
provider-url: "{{ mcphost_provider_url }}"
{% endif %}
{% if mcphost_provider_api_key_resolved is defined and mcphost_provider_api_key_resolved %}
provider-api-key: "{{ mcphost_provider_api_key_resolved }}"
{% endif %}
{% if mcphost_tls_skip_verify %}
tls-skip-verify: {{ mcphost_tls_skip_verify | lower }}
{% endif %}

# Model generation parameters
max-tokens: {{ mcphost_max_tokens }}
temperature: {{ mcphost_temperature }}
{% if mcphost_top_p is defined %}
top-p: {{ mcphost_top_p }}
{% endif %}
{% if mcphost_top_k is defined %}
top-k: {{ mcphost_top_k }}
{% endif %}
{% if mcphost_stop_sequences | length > 0 %}
stop-sequences: {{ mcphost_stop_sequences | to_json }}
{% endif %}

# Agent configuration
max-steps: {{ mcphost_max_steps }}
stream: {{ mcphost_stream | lower }}
debug: {{ mcphost_debug | lower }}

# System prompt
{% if mcphost_system_prompt_file %}
system-prompt: "{{ mcphost_system_prompt_file }}"
{% elif mcphost_system_prompt %}
system-prompt: |
{{ mcphost_system_prompt | indent(2) }}
{% endif %}

# MCP Servers configuration
# Discovered and manually configured servers are already in mcphost's native format
# Just output them directly using to_nice_yaml
mcpServers:
{% if final_mcp_servers is defined and final_mcp_servers | length > 0 %}
{{ final_mcp_servers | to_nice_yaml | indent(2, first=True) }}
{% else %}
  {}
{% endif %}
